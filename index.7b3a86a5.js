!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=t.parcelRequired7c6;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){r[e]=t},t.parcelRequired7c6=i),i("fkvfI"),i("4Nugj"),i("euqRf");var s=i("fkvfI"),o=i("4Nugj"),a=i("Db1qJ"),u=i("jcFG7"),c=i("bXAnp"),d=i("4smAb"),l=i("gQOBw"),f=i("euqRf");i("6m2hf"),(0,l.onAuthStateChanged)(f.auth,(function(e){e?(console.log("user logged in: ",e),o.refs.authSignOut.parentElement.classList.remove("hidden"),o.refs.authOpen.parentElement.classList.add("hidden")):(console.log("user logged out"),o.refs.authSignOut.parentElement.classList.add("hidden"),o.refs.authOpen.parentElement.classList.remove("hidden"))})),d.spinner.show(),s.movieApi.getTrending().then((function(e){console.log(e.results),u.paginationSettings.maxPages=e.total_pages,console.log(u.paginationSettings),(0,u.initializePagination)();var t=e.results.map(a.dataFormat).map(c.cardTemplate).join("");o.refs.movieList.innerHTML=t,d.spinner.close()})),o.refs.pagination.classList.remove("visually-hidden");s=i("fkvfI"),o=i("4Nugj"),a=i("Db1qJ"),c=i("bXAnp"),u=i("jcFG7"),d=i("4smAb");var p=i("iU1Pc");o.refs.searchForm.addEventListener("submit",(function(t){t.preventDefault();var n=t.currentTarget.elements.search.value;if(""===n)return void document.querySelector(".error-msg").classList.remove("transparent");n!==s.movieApi.query&&(s.movieApi.query=n);d.spinner.show(),u.paginationSettings.paginationType="search",console.log(u.paginationSettings.paginationType),s.movieApi.resetPage(),s.movieApi.searchMovies().then((function(t){if(0===t.results.length)return e(p).Notify.failure("No matches"),void d.spinner.close();console.log(t),u.paginationSettings.maxPages=t.total_pages,console.log(u.paginationSettings),(0,u.initializePagination)();var n=t.results.map(a.dataFormat).map(c.cardTemplate).join("");o.refs.movieList.innerHTML=n,d.spinner.close()}))})),i("jcFG7");var g,v,m,h=i("bpxeT"),b=i("2TvXO"),y=(o=i("4Nugj"),s=i("fkvfI"),a=i("Db1qJ"),f=i("euqRf"),c=i("bXAnp"),i("6m2hf"));p=i("iU1Pc");function L(){o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),window.removeEventListener("keydown",k),o.refs.modalCloseBtn.removeEventListener("click",L),o.refs.backdrop.removeEventListener("click",w),g.removeEventListener("click",E),v.removeEventListener("click",x)}function k(e){console.log(e.code),"Escape"===e.code&&L()}function w(e){e.target===e.currentTarget&&L()}function E(){return q.apply(this,arguments)}function q(){return(q=e(h)(e(b).mark((function t(){var n,r,i,s,o;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.auth.currentUser){t.next=3;break}return e(p).Notify.failure("Please sign in"),t.abrupt("return");case 3:return t.next=5,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 5:if(n=t.sent,console.log(n),r=n.userId,i=n.watchedMovies,s=n.queuedMovies,o=n.userEmail,!i.find((function(e){return e.id===m.id}))){t.next=12;break}return e(p).Notify.failure("Already in collection"),t.abrupt("return");case 12:return i.push(m),t.next=15,(0,y.setDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{userId:r,userEmail:o,watchedMovies:i,queuedMovies:s});case 15:e(p).Notify.success("Added to watched");case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(){return A.apply(this,arguments)}function A(){return(A=e(h)(e(b).mark((function t(){var n,r,i,s,o;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.auth.currentUser){t.next=3;break}return e(p).Notify.failure("Please sign in"),t.abrupt("return");case 3:return t.next=5,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 5:if(n=t.sent,console.log(n),r=n.userId,i=n.watchedMovies,s=n.queuedMovies,o=n.userEmail,!s.find((function(e){return e.id===m.id}))){t.next=12;break}return e(p).Notify.failure("Already in collection"),t.abrupt("return");case 12:return s.push(m),t.next=15,(0,y.setDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{userId:r,userEmail:o,watchedMovies:i,queuedMovies:s});case 15:e(p).Notify.success("Added to queue");case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}o.refs.movieList.addEventListener("click",(function(e){if(e.target===e.currentTarget)return;var t=e.target.closest("li");s.movieApi.id=t.dataset.id,s.movieApi.getMovie().then((function(e){var t=(0,a.dataFormat)(e);m=t,console.log(m);var n=(0,c.selectedMovieTemplate)(t);o.refs.movieModal.innerHTML=n,g=document.querySelector("[data-watched-add]"),v=document.querySelector("[data-queue-add]"),g.addEventListener("click",E),v.addEventListener("click",x),o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),o.refs.modalCloseBtn.addEventListener("click",L),window.addEventListener("keydown",k),o.refs.backdrop.addEventListener("click",w)}))})),i("2yGCU"),i("4smAb")}();
//# sourceMappingURL=index.7b3a86a5.js.map
