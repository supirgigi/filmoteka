{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/@parcel/runtime-js/lib/runtime-ab3986aa1ae048ce.js","src/library.js","src/js/library.js","node_modules/@parcel/runtime-js/lib/runtime-01358d8f61044af8.js","src/js/libraryModal.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","\"use strict\";\n\nvar bundleURL = {};\n\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n\n  return value;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|(chrome|moz)-extension):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|(chrome|moz)-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp|(chrome|moz)-extension):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"2Y0K8\\\":\\\"library.d681ea7c.js\\\",\\\"cTykl\\\":\\\"sad-dog.fb588d9a.jpg\\\",\\\"2hvCh\\\":\\\"index.48457f01.js\\\"}\"));","import './js/Api';\nimport './js/refs';\nimport './js/auth';\nimport './js/library';\nimport './js/pagination';\nimport './js/libraryModal';\nimport './js/authModal';\nimport './js/preloader';\n","import { refs } from './refs';\nimport { getDoc, doc } from 'firebase/firestore';\nimport { paginationSettings } from './pagination';\nimport { movieApi } from './Api';\nimport { cardLibraryTemplate } from './cardTemplate';\nimport { initializePagination } from './pagination';\nimport Notiflix from 'notiflix';\nimport { spinner } from './preloader';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { auth, db } from './auth';\nimport emptyColPic from '../images/sad-dog.jpg';\n\nconst watchedBtn = document.querySelector('[data-watched]');\nconst queueBtn = document.querySelector('[data-queue]');\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    // docRef = doc(db, 'users', `${user.uid}`);\n    console.log('user logged in: ', user);\n    refs.authSignOut.parentElement.classList.remove('hidden');\n    refs.authOpen.parentElement.classList.add('hidden');\n    onWatchedClick();\n    // console.log(docRef);\n  } else {\n    console.log('user logged out');\n    refs.authSignOut.parentElement.classList.add('hidden');\n    refs.authOpen.parentElement.classList.remove('hidden');\n    refs.pagination.classList.add('visually-hidden');\n    // refs.movieList.innerHTML = `<img src=${emptyColPic} style=\"margin: 0 auto;\"></img>`;\n    // docRef = null;\n    // console.log(docRef);\n  }\n});\n\nwatchedBtn.addEventListener('click', onWatchedClick);\nqueueBtn.addEventListener('click', onQueueClick);\n\nasync function onWatchedClick() {\n  if (!auth.currentUser) {\n    Notiflix.Notify.failure('Please sign in');\n    return;\n  }\n\n  spinner.show();\n\n  movieApi.resetPage();\n\n  refs.movieList.innerHTML = '';\n  watchedBtn.classList.add('library-btns__btn_current');\n  queueBtn.classList.remove('library-btns__btn_current');\n\n  const { watchedMovies } = await getDoc(\n    doc(db, 'users', auth.currentUser.uid)\n  ).then(res => {\n    return res.data();\n  });\n\n  paginationSettings.paginationType = 'watched';\n  paginationSettings.maxPages = Math.ceil(\n    watchedMovies.length / paginationSettings.perPage\n  );\n\n  console.log('watched movies: ', watchedMovies);\n  console.log(paginationSettings.maxPages);\n  initializePagination();\n\n  const paginatedResults = watchedMovies.filter((result, index) => {\n    return index < movieApi.page * paginationSettings.perPage;\n  });\n  // console.log('paginated results: ', paginatedResults);\n  const markup = paginatedResults.map(cardLibraryTemplate).join('');\n  refs.movieList.innerHTML = markup;\n  spinner.close();\n}\n\nasync function onQueueClick() {\n  if (!auth.currentUser) {\n    Notiflix.Notify.failure('Please sign in');\n    return;\n  }\n\n  spinner.show();\n\n  movieApi.resetPage();\n\n  refs.movieList.innerHTML = '';\n  watchedBtn.classList.remove('library-btns__btn_current');\n  queueBtn.classList.add('library-btns__btn_current');\n\n  const { queuedMovies } = await getDoc(\n    doc(db, 'users', auth.currentUser.uid)\n  ).then(res => {\n    return res.data();\n  });\n\n  paginationSettings.paginationType = 'queue';\n  paginationSettings.maxPages = Math.ceil(\n    queuedMovies.length / paginationSettings.perPage\n  );\n\n  console.log('queue movies: ', queuedMovies);\n  console.log(paginationSettings.maxPages);\n  initializePagination();\n  const paginatedResults = queuedMovies.filter((result, index) => {\n    return index < movieApi.page * paginationSettings.perPage;\n  });\n  // console.log('paginated results: ', paginatedResults);\n  const markup = paginatedResults.map(cardLibraryTemplate).join('');\n  refs.movieList.innerHTML = markup;\n\n  spinner.close();\n}\n","module.exports = require('./helpers/bundle-url').getBundleURL('2Y0K8') + require('./helpers/bundle-manifest').resolve(\"cTykl\");","import { refs } from './refs';\nimport { movieApi } from './Api';\nimport { dataFormat } from './dataFormat';\nimport { auth, db } from './auth';\nimport {\n  cardLibraryTemplate,\n  selectedQueueTemplate,\n  selectedWatchedTemplate,\n} from './cardTemplate';\nimport { getDoc, doc, setDoc } from 'firebase/firestore';\nimport { initializePagination, paginationSettings } from './pagination';\nimport Notiflix from 'notiflix';\n\nrefs.movieList.addEventListener('click', onLibraryClick);\n\nlet watchedRemove;\nlet queueRemove;\nlet currentMovie;\n\nfunction onLibraryClick(e) {\n  if (e.target === e.currentTarget) {\n    return;\n  }\n  const card = e.target.closest('li');\n  movieApi.id = card.dataset.id;\n  movieApi.getMovie().then(data => {\n    const formattedData = dataFormat(data);\n    currentMovie = formattedData;\n    let modalMarkup;\n    console.log(currentMovie);\n\n    if (paginationSettings.paginationType === 'watched') {\n      modalMarkup = selectedWatchedTemplate(formattedData);\n      refs.movieModal.innerHTML = modalMarkup;\n      onWatchedCard();\n    } else {\n      modalMarkup = selectedQueueTemplate(formattedData);\n      refs.movieModal.innerHTML = modalMarkup;\n      onQueueCard();\n    }\n\n    refs.backdrop.classList.toggle('is-hidden');\n    refs.body.classList.toggle('locked');\n\n    refs.modalCloseBtn.addEventListener('click', toggleLibraryModal);\n    window.addEventListener('keydown', onEscPress);\n    refs.backdrop.addEventListener('click', onBackdropClick);\n  });\n}\n\nfunction onWatchedCard() {\n  watchedRemove = document.querySelector('[data-watched-remove]');\n  watchedRemove.addEventListener('click', removeFromWatched);\n}\n\nfunction onQueueCard() {\n  queueRemove = document.querySelector('[data-queue-remove]');\n  queueRemove.addEventListener('click', removeFromQueue);\n}\n\nasync function removeFromWatched() {\n  const { userId, userEmail, watchedMovies, queuedMovies } = await getDoc(\n    doc(db, 'users', auth.currentUser.uid)\n  ).then(res => {\n    return res.data();\n  });\n  const filtered = watchedMovies.filter(movie => {\n    return movie.id !== currentMovie.id;\n  });\n  await setDoc(doc(db, 'users', auth.currentUser.uid), {\n    userId,\n    userEmail,\n    watchedMovies: filtered,\n    queuedMovies,\n  });\n  paginationSettings.maxPages = Math.ceil(filtered.length / 20);\n  let paginatedResults = filtered.filter((result, index) => {\n    return index < movieApi.page * 20 && index >= movieApi.page * 20 - 20;\n  });\n\n  console.log(paginatedResults);\n\n  if (paginatedResults.length === 0) {\n    console.log('empty');\n    movieApi.page -= 1;\n    paginatedResults = filtered.filter((result, index) => {\n      return index < movieApi.page * 20 && index >= movieApi.page * 20 - 20;\n    });\n  }\n  const markup = paginatedResults.map(cardLibraryTemplate).join('');\n  refs.movieList.innerHTML = markup;\n  initializePagination();\n  toggleLibraryModal();\n  Notiflix.Notify.success('Removed successfully');\n}\n\nasync function removeFromQueue() {\n  const { userId, userEmail, watchedMovies, queuedMovies } = await getDoc(\n    doc(db, 'users', auth.currentUser.uid)\n  ).then(res => {\n    return res.data();\n  });\n  const filtered = queuedMovies.filter(movie => {\n    return movie.id !== currentMovie.id;\n  });\n  await setDoc(doc(db, 'users', auth.currentUser.uid), {\n    userId,\n    userEmail,\n    watchedMovies,\n    queuedMovies: filtered,\n  });\n  paginationSettings.maxPages = Math.ceil(filtered.length / 20);\n  let paginatedResults = filtered.filter((result, index) => {\n    return index < movieApi.page * 20 && index >= movieApi.page * 20 - 20;\n  });\n\n  console.log(paginatedResults);\n\n  if (paginatedResults.length === 0) {\n    console.log('empty');\n    movieApi.page -= 1;\n    paginatedResults = filtered.filter((result, index) => {\n      return index < movieApi.page * 20 && index >= movieApi.page * 20 - 20;\n    });\n  }\n  const markup = paginatedResults.map(cardLibraryTemplate).join('');\n  refs.movieList.innerHTML = markup;\n  initializePagination();\n  toggleLibraryModal();\n  Notiflix.Notify.success('Removed successfully');\n}\n\nfunction toggleLibraryModal() {\n  refs.backdrop.classList.toggle('is-hidden');\n  refs.body.classList.toggle('locked');\n  window.removeEventListener('keydown', onEscPress);\n  refs.modalCloseBtn.removeEventListener('click', toggleLibraryModal);\n  refs.backdrop.removeEventListener('click', onBackdropClick);\n  if (watchedRemove) {\n    watchedRemove.removeEventListener('click', removeFromWatched);\n  } else {\n    queueRemove.removeEventListener('click', removeFromQueue);\n  }\n}\n\nfunction onEscPress(e) {\n  if ((e.code = 'ESC')) {\n    toggleLibraryModal();\n  }\n}\n\nfunction onBackdropClick(e) {\n  if (e.target === e.currentTarget) {\n    toggleLibraryModal();\n  }\n}\n"],"names":["$0380ce8f1f064ccc$export$6503ec6e8aabbaf","$0380ce8f1f064ccc$export$f7ad0328861e2f03","$0380ce8f1f064ccc$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","$7dd1ddf6834435ca$export$bdfd709ae4826697","$7dd1ddf6834435ca$var$bundleURL","$7dd1ddf6834435ca$var$getBaseURL","url","replace","value","err","matches","stack","match","$7dd1ddf6834435ca$var$getBundleURL","parcelRequire","register","JSON","parse","$bpxeT","getBundleURL","resolve","$93effc6fc56091ad$var$watchedBtn","document","querySelector","$93effc6fc56091ad$var$queueBtn","$93effc6fc56091ad$var$onWatchedClick","$93effc6fc56091ad$var$_onWatchedClick","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","watchedMovies","paginatedResults","markup","$euqRf","auth","currentUser","$iU1Pc","Notify","failure","$4smAb","spinner","show","$fkvfI","movieApi","resetPage","$4Nugj","refs","movieList","innerHTML","classList","add","remove","$6m2hf","getDoc","doc","db","uid","then","res","data","_ctx","sent","$jcFG7","paginationSettings","paginationType","maxPages","Math","ceil","perPage","console","log","initializePagination","filter","result","index","page","map","$bXAnp","cardLibraryTemplate","join","close","$93effc6fc56091ad$var$_onQueueClick","queuedMovies","$gQOBw","onAuthStateChanged","user","authSignOut","parentElement","authOpen","pagination","addEventListener","$c0832a3ae1aa9857$var$watchedRemove","$c0832a3ae1aa9857$var$queueRemove","$c0832a3ae1aa9857$var$currentMovie","$c0832a3ae1aa9857$var$removeFromWatched","$c0832a3ae1aa9857$var$_removeFromWatched","ref","userId","userEmail","filtered","movie","setDoc","$c0832a3ae1aa9857$var$toggleLibraryModal","success","$c0832a3ae1aa9857$var$removeFromQueue","$c0832a3ae1aa9857$var$_removeFromQueue","backdrop","toggle","body","window","removeEventListener","$c0832a3ae1aa9857$var$onEscPress","modalCloseBtn","$c0832a3ae1aa9857$var$onBackdropClick","e","code","target","currentTarget","card","closest","dataset","getMovie","modalMarkup","formattedData","$Db1qJ","dataFormat","selectedWatchedTemplate","movieModal","selectedQueueTemplate"],"version":3,"file":"library.d681ea7c.js.map"}