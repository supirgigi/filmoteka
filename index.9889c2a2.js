!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},s=t.parcelRequired7c6;null==s&&((s=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var s={id:e,exports:{}};return n[e]=s,t.call(s.exports,s,s.exports),s.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){r[e]=t},t.parcelRequired7c6=s),s("fkvfI"),s("4Nugj"),s("euqRf");var i=s("fkvfI"),a=s("4Nugj"),o=s("Db1qJ"),c=s("jcFG7"),u=s("bXAnp"),d=s("4smAb"),l=s("gQOBw"),f=s("euqRf");s("6m2hf"),(0,l.onAuthStateChanged)(f.auth,(function(e){e?(console.log("user logged in: ",e),a.refs.authSignOut.parentElement.classList.remove("hidden"),a.refs.authOpen.parentElement.classList.add("hidden")):(console.log("user logged out"),a.refs.authSignOut.parentElement.classList.add("hidden"),a.refs.authOpen.parentElement.classList.remove("hidden"))})),function(){d.spinner.show();try{i.movieApi.getTrending().then((function(e){console.log(e.results),c.paginationSettings.maxPages=e.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();var t=e.results.map(o.dataFormat).map(u.cardTemplate).join("");a.refs.movieList.innerHTML=t,a.refs.pagination.classList.remove("visually-hidden")}))}catch(e){Notiflix.Notify.failure(e.message)}finally{d.spinner.close()}}();i=s("fkvfI"),a=s("4Nugj"),o=s("Db1qJ"),u=s("bXAnp"),c=s("jcFG7"),d=s("4smAb");var v=s("iU1Pc");a.refs.searchForm.addEventListener("submit",(function(t){t.preventDefault();var n=t.currentTarget.elements.search.value;if(""===n)return void e(v).Notify.failure("Please enter correct movie title");n!==i.movieApi.query&&(i.movieApi.query=n);d.spinner.show(),c.paginationSettings.paginationType="search",console.log(c.paginationSettings.paginationType),i.movieApi.resetPage();try{i.movieApi.searchMovies().then((function(t){if(0===t.results.length)return e(v).Notify.failure("No matches"),void d.spinner.close();console.log(t),c.paginationSettings.maxPages=t.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();var n=t.results.map(o.dataFormat).map(u.cardTemplate).join("");a.refs.movieList.innerHTML=n}))}catch(t){e(v).Notify.failure(t.message)}finally{d.spinner.close()}})),s("jcFG7");var p,h,m,g=s("bpxeT"),b=s("2TvXO"),y=(a=s("4Nugj"),i=s("fkvfI"),o=s("Db1qJ"),f=s("euqRf"),u=s("bXAnp"),s("6m2hf"));v=s("iU1Pc");function k(){return k=e(g)(e(b).mark((function t(n){var r;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.target!==n.currentTarget){t.next=2;break}return t.abrupt("return");case 2:r=n.target.closest("li"),i.movieApi.id=r.dataset.id;try{i.movieApi.getMovie().then(function(){var t=e(g)(e(b).mark((function t(n){var r,s,i,c,d,l,v;return e(b).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,o.dataFormat)(n),m=r,s=(0,u.selectedMovieTemplate)(r),a.refs.movieModal.innerHTML=s,L(),!f.auth.currentUser){e.next=15;break}return e.next=8,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 8:i=e.sent,console.log(i),c=i.watchedMovies,d=i.queuedMovies,l=c.find((function(e){return e.id===m.id})),v=d.find((function(e){return e.id===m.id})),l&&M(),v&&q();case 15:a.refs.backdrop.classList.toggle("is-hidden"),a.refs.body.classList.toggle("locked"),a.refs.modalCloseBtn.addEventListener("click",w),window.addEventListener("keydown",x),a.refs.backdrop.addEventListener("click",E);case 20:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(t){e(v).Notify.failure(t.message)}case 5:case"end":return t.stop()}}),t)}))),k.apply(this,arguments)}function L(){p=document.querySelector("[data-watched-add]"),h=document.querySelector("[data-queue-add]"),p.addEventListener("click",N),h.addEventListener("click",A)}function w(){a.refs.backdrop.classList.toggle("is-hidden"),a.refs.body.classList.toggle("locked"),window.removeEventListener("keydown",x),a.refs.modalCloseBtn.removeEventListener("click",w),a.refs.backdrop.removeEventListener("click",E),p.removeEventListener("click",N),h.removeEventListener("click",A),p.removeEventListener("click",T),h.removeEventListener("click",I)}function x(e){console.log(e.code),"Escape"===e.code&&w()}function E(e){e.target===e.currentTarget&&w()}function M(){"add to watched"===p.textContent?(p.textContent="remove from watched",p.removeEventListener("click",N),p.addEventListener("click",T),p.classList.add("modal-card-buttons__btn_current")):(p.textContent="add to watched",p.addEventListener("click",N),p.removeEventListener("click",T),p.classList.remove("modal-card-buttons__btn_current"))}function q(){"add to queue"===h.textContent?(h.textContent="remove from queue",h.removeEventListener("click",A),h.addEventListener("click",I),h.classList.add("modal-card-buttons__btn_current")):(h.textContent="add to queue",h.addEventListener("click",A),h.removeEventListener("click",I),h.classList.remove("modal-card-buttons__btn_current"))}function N(){return _.apply(this,arguments)}function _(){return(_=e(g)(e(b).mark((function t(){var n,r,s,i,a;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.auth.currentUser){t.next=3;break}return e(v).Notify.failure("Please sign in"),t.abrupt("return");case 3:return t.prev=3,t.next=6,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 6:return n=t.sent,r=n.userId,s=n.watchedMovies,i=n.queuedMovies,a=n.userEmail,s.push(m),t.next=11,(0,y.setDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{userId:r,userEmail:a,watchedMovies:s,queuedMovies:i}).then((function(){e(v).Notify.success("Added to watched"),M()}));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),e(v).Notify.failure(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function T(){return U.apply(this,arguments)}function U(){return(U=e(g)(e(b).mark((function t(){var n,r,s,i,a,o;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 3:return n=t.sent,r=n.userId,s=n.userEmail,i=n.watchedMovies,a=n.queuedMovies,o=i.filter((function(e){return e.id!==m.id})),t.next=11,(0,y.setDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{userId:r,userEmail:s,watchedMovies:o,queuedMovies:a}).then((function(){e(v).Notify.success("Removed successfully"),M()}));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),e(v).Notify.failure(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))).apply(this,arguments)}function A(){return D.apply(this,arguments)}function D(){return(D=e(g)(e(b).mark((function t(){var n,r,s,i,a;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.auth.currentUser){t.next=3;break}return e(v).Notify.failure("Please sign in"),t.abrupt("return");case 3:return t.prev=3,t.next=6,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 6:return n=t.sent,r=n.userId,s=n.watchedMovies,i=n.queuedMovies,a=n.userEmail,i.push(m),t.next=11,(0,y.setDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{userId:r,userEmail:a,watchedMovies:s,queuedMovies:i}).then((function(){e(v).Notify.success("Added to queue"),q()}));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),e(v).Notify.failure(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function I(){return C.apply(this,arguments)}function C(){return(C=e(g)(e(b).mark((function t(){var n,r,s,i,a,o;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 3:return n=t.sent,r=n.userId,s=n.userEmail,i=n.watchedMovies,a=n.queuedMovies,o=a.filter((function(e){return e.id!==m.id})),t.next=11,(0,y.setDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{userId:r,userEmail:s,watchedMovies:i,queuedMovies:o}).then((function(){e(v).Notify.success("Removed successfully"),q()}));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),e(v).Notify.failure(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))).apply(this,arguments)}a.refs.movieList.addEventListener("click",(function(e){return k.apply(this,arguments)})),s("2yGCU"),s("4smAb")}();
//# sourceMappingURL=index.9889c2a2.js.map
