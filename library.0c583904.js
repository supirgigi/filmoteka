function e(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},a={},r=i.parcelRequired7c6;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},i.parcelRequired7c6=r),r.register("kyEFX",(function(t,i){var n,a;e(t.exports,"register",(function(){return n}),(function(e){return n=e})),e(t.exports,"resolve",(function(){return a}),(function(e){return a=e}));var r={};n=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)r[t[i]]=e[t[i]]},a=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("kyEFX").register(JSON.parse('{"1zJhX":"library.0c583904.js","iqSmM":"sad-dog.fb588d9a.jpg","b9auz":"index.e161d31d.js"}')),r("epB3k"),r("krGWQ"),r("bMZn5");var o=r("krGWQ"),s=r("ftYLF"),c=r("2nhTy"),d=r("epB3k"),l=r("9L75J"),u=(c=r("2nhTy"),r("eWCmQ")),g=r("ioBS9"),p=r("eyjy7"),f=r("bMZn5");new URL(r("kyEFX").resolve("iqSmM"),import.meta.url).toString();const m=document.querySelector("[data-watched]"),v=document.querySelector("[data-queue]");async function h(){if(!f.auth.currentUser)return void t(u).Notify.failure("Please sign in");g.spinner.show(),d.movieApi.resetPage(),o.refs.movieList.innerHTML="",m.classList.add("library-btns__btn_current"),v.classList.remove("library-btns__btn_current");const{watchedMovies:e}=await(0,s.getDoc)((0,s.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));c.paginationSettings.paginationType="watched",c.paginationSettings.maxPages=Math.ceil(e.length/c.paginationSettings.perPage),console.log("watched movies: ",e),console.log(c.paginationSettings.maxPages),(0,c.initializePagination)();const i=e.filter(((e,t)=>t<d.movieApi.page*c.paginationSettings.perPage)).map(l.cardLibraryTemplate).join("");o.refs.movieList.innerHTML=i,g.spinner.close()}(0,p.onAuthStateChanged)(f.auth,(e=>{e?(console.log("user logged in: ",e),o.refs.authSignOut.parentElement.classList.remove("hidden"),o.refs.authOpen.parentElement.classList.add("hidden"),h()):(console.log("user logged out"),o.refs.authSignOut.parentElement.classList.add("hidden"),o.refs.authOpen.parentElement.classList.remove("hidden"),o.refs.pagination.classList.add("visually-hidden"))})),m.addEventListener("click",h),v.addEventListener("click",(async function(){if(!f.auth.currentUser)return void t(u).Notify.failure("Please sign in");g.spinner.show(),d.movieApi.resetPage(),o.refs.movieList.innerHTML="",m.classList.remove("library-btns__btn_current"),v.classList.add("library-btns__btn_current");const{queuedMovies:e}=await(0,s.getDoc)((0,s.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));c.paginationSettings.paginationType="queue",c.paginationSettings.maxPages=Math.ceil(e.length/c.paginationSettings.perPage),console.log("queue movies: ",e),console.log(c.paginationSettings.maxPages),(0,c.initializePagination)();const i=e.filter(((e,t)=>t<d.movieApi.page*c.paginationSettings.perPage)).map(l.cardLibraryTemplate).join("");o.refs.movieList.innerHTML=i,g.spinner.close()})),r("2nhTy");o=r("krGWQ"),d=r("epB3k");var b=r("kFh99");f=r("bMZn5"),l=r("9L75J"),s=r("ftYLF"),c=r("2nhTy"),u=r("eWCmQ");let L,y,w;async function M(){const{userId:e,userEmail:i,watchedMovies:n,queuedMovies:a}=await(0,s.getDoc)((0,s.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data())),r=n.filter((e=>e.id!==w.id));await(0,s.setDoc)((0,s.doc)(f.db,"users",f.auth.currentUser.uid),{userId:e,userEmail:i,watchedMovies:r,queuedMovies:a}),c.paginationSettings.maxPages=Math.ceil(r.length/20);let g=r.filter(((e,t)=>t<20*d.movieApi.page&&t>=20*d.movieApi.page-20));console.log(g),0===g.length&&(console.log("empty"),d.movieApi.page-=1,g=r.filter(((e,t)=>t<20*d.movieApi.page&&t>=20*d.movieApi.page-20)));const p=g.map(l.cardLibraryTemplate).join("");o.refs.movieList.innerHTML=p,(0,c.initializePagination)(),k(),t(u).Notify.success("Removed successfully")}async function E(){const{userId:e,userEmail:i,watchedMovies:n,queuedMovies:a}=await(0,s.getDoc)((0,s.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data())),r=a.filter((e=>e.id!==w.id));await(0,s.setDoc)((0,s.doc)(f.db,"users",f.auth.currentUser.uid),{userId:e,userEmail:i,watchedMovies:n,queuedMovies:r}),c.paginationSettings.maxPages=Math.ceil(r.length/20);let g=r.filter(((e,t)=>t<20*d.movieApi.page&&t>=20*d.movieApi.page-20));console.log(g),0===g.length&&(console.log("empty"),d.movieApi.page-=1,g=r.filter(((e,t)=>t<20*d.movieApi.page&&t>=20*d.movieApi.page-20)));const p=g.map(l.cardLibraryTemplate).join("");o.refs.movieList.innerHTML=p,(0,c.initializePagination)(),k(),t(u).Notify.success("Removed successfully")}function k(){o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),window.removeEventListener("keydown",S),o.refs.modalCloseBtn.removeEventListener("click",k),o.refs.backdrop.removeEventListener("click",T),L?L.removeEventListener("click",M):y.removeEventListener("click",E)}function S(e){e.code="ESC",k()}function T(e){e.target===e.currentTarget&&k()}o.refs.movieList.addEventListener("click",(function(e){if(e.target===e.currentTarget)return;const t=e.target.closest("li");d.movieApi.id=t.dataset.id,d.movieApi.getMovie().then((e=>{const t=(0,b.dataFormat)(e);let i;w=t,console.log(w),"watched"===c.paginationSettings.paginationType?(i=(0,l.selectedWatchedTemplate)(t),o.refs.movieModal.innerHTML=i,L=document.querySelector("[data-watched-remove]"),L.addEventListener("click",M)):(i=(0,l.selectedQueueTemplate)(t),o.refs.movieModal.innerHTML=i,y=document.querySelector("[data-queue-remove]"),y.addEventListener("click",E)),o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),o.refs.modalCloseBtn.addEventListener("click",k),window.addEventListener("keydown",S),o.refs.backdrop.addEventListener("click",T)}))})),r("hMaZ9"),r("ioBS9");
//# sourceMappingURL=library.0c583904.js.map
