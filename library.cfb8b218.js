!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},i={},a=n.parcelRequired7c6;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},n.parcelRequired7c6=a),a.register("iE7OH",(function(t,n){var r,i;e(t.exports,"register",(function(){return r}),(function(e){return r=e})),e(t.exports,"resolve",(function(){return i}),(function(e){return i=e}));var a={};r=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)a[t[n]]=e[t[n]]},i=function(e){var t=a[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a.register("aNJCr",(function(t,n){var r;e(t.exports,"getBundleURL",(function(){return r}),(function(e){return r=e}));var i={};function a(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}r=function(e){var t=i[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz)-extension):\/\/[^)\n]+/g);if(e)return a(e[2])}return"/"}(),i[e]=t),t}})),a("iE7OH").register(JSON.parse('{"2Y0K8":"library.cfb8b218.js","cTykl":"sad-dog.fb588d9a.jpg","2hvCh":"index.28546c36.js"}')),a("fkvfI"),a("4Nugj"),a("euqRf");var o=a("bpxeT"),s=a("2TvXO"),c=a("4Nugj"),u=a("6m2hf"),l=a("jcFG7"),d=a("fkvfI"),p=a("bXAnp"),f=(l=a("jcFG7"),a("iU1Pc")),g=a("4smAb"),v=a("gQOBw"),m=a("euqRf");a("aNJCr").getBundleURL("2Y0K8"),a("iE7OH").resolve("cTykl");var h=document.querySelector("[data-watched]"),b=document.querySelector("[data-queue]");function L(){return y.apply(this,arguments)}function y(){return(y=t(o)(t(s).mark((function e(){var n,r,i;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.auth.currentUser){e.next=3;break}return t(f).Notify.failure("Please sign in"),e.abrupt("return");case 3:return g.spinner.show(),d.movieApi.resetPage(),c.refs.movieList.innerHTML="",h.classList.add("library-btns__btn_current"),b.classList.remove("library-btns__btn_current"),e.next=10,(0,u.getDoc)((0,u.doc)(m.db,"users",m.auth.currentUser.uid)).then((function(e){return e.data()}));case 10:n=e.sent.watchedMovies,l.paginationSettings.paginationType="watched",l.paginationSettings.maxPages=Math.ceil(n.length/l.paginationSettings.perPage),console.log("watched movies: ",n),console.log(l.paginationSettings.maxPages),(0,l.initializePagination)(),r=n.filter((function(e,t){return t<d.movieApi.page*l.paginationSettings.perPage})),i=r.map(p.cardLibraryTemplate).join(""),c.refs.movieList.innerHTML=i,g.spinner.close();case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=t(o)(t(s).mark((function e(){var n,r,i;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.auth.currentUser){e.next=3;break}return t(f).Notify.failure("Please sign in"),e.abrupt("return");case 3:return g.spinner.show(),d.movieApi.resetPage(),c.refs.movieList.innerHTML="",h.classList.remove("library-btns__btn_current"),b.classList.add("library-btns__btn_current"),e.next=10,(0,u.getDoc)((0,u.doc)(m.db,"users",m.auth.currentUser.uid)).then((function(e){return e.data()}));case 10:n=e.sent.queuedMovies,l.paginationSettings.paginationType="queue",l.paginationSettings.maxPages=Math.ceil(n.length/l.paginationSettings.perPage),console.log("queue movies: ",n),console.log(l.paginationSettings.maxPages),(0,l.initializePagination)(),r=n.filter((function(e,t){return t<d.movieApi.page*l.paginationSettings.perPage})),i=r.map(p.cardLibraryTemplate).join(""),c.refs.movieList.innerHTML=i,g.spinner.close();case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,v.onAuthStateChanged)(m.auth,(function(e){e?(console.log("user logged in: ",e),c.refs.authSignOut.parentElement.classList.remove("hidden"),c.refs.authOpen.parentElement.classList.add("hidden"),L()):(console.log("user logged out"),c.refs.authSignOut.parentElement.classList.add("hidden"),c.refs.authOpen.parentElement.classList.remove("hidden"),c.refs.pagination.classList.add("visually-hidden"))})),h.addEventListener("click",L),b.addEventListener("click",(function(){return w.apply(this,arguments)})),a("jcFG7");o=a("bpxeT"),s=a("2TvXO"),c=a("4Nugj"),d=a("fkvfI");var k,E,x,T=a("Db1qJ");m=a("euqRf"),p=a("bXAnp"),u=a("6m2hf"),l=a("jcFG7"),f=a("iU1Pc");function M(){return S.apply(this,arguments)}function S(){return(S=t(o)(t(s).mark((function e(){var n,r,i,a,o,g,v,h;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.getDoc)((0,u.doc)(m.db,"users",m.auth.currentUser.uid)).then((function(e){return e.data()}));case 2:return n=e.sent,r=n.userId,i=n.userEmail,a=n.watchedMovies,o=n.queuedMovies,g=a.filter((function(e){return e.id!==x.id})),e.next=10,(0,u.setDoc)((0,u.doc)(m.db,"users",m.auth.currentUser.uid),{userId:r,userEmail:i,watchedMovies:g,queuedMovies:o});case 10:l.paginationSettings.maxPages=Math.ceil(g.length/20),v=g.filter((function(e,t){return t<20*d.movieApi.page&&t>=20*d.movieApi.page-20})),console.log(v),0===v.length&&(console.log("empty"),d.movieApi.page-=1,v=g.filter((function(e,t){return t<20*d.movieApi.page&&t>=20*d.movieApi.page-20}))),h=v.map(p.cardLibraryTemplate).join(""),c.refs.movieList.innerHTML=h,(0,l.initializePagination)(),P(),t(f).Notify.success("Removed successfully");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return _.apply(this,arguments)}function _(){return(_=t(o)(t(s).mark((function e(){var n,r,i,a,o,g,v,h;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.getDoc)((0,u.doc)(m.db,"users",m.auth.currentUser.uid)).then((function(e){return e.data()}));case 2:return n=e.sent,r=n.userId,i=n.userEmail,a=n.watchedMovies,o=n.queuedMovies,g=o.filter((function(e){return e.id!==x.id})),e.next=10,(0,u.setDoc)((0,u.doc)(m.db,"users",m.auth.currentUser.uid),{userId:r,userEmail:i,watchedMovies:a,queuedMovies:g});case 10:l.paginationSettings.maxPages=Math.ceil(g.length/20),v=g.filter((function(e,t){return t<20*d.movieApi.page&&t>=20*d.movieApi.page-20})),console.log(v),0===v.length&&(console.log("empty"),d.movieApi.page-=1,v=g.filter((function(e,t){return t<20*d.movieApi.page&&t>=20*d.movieApi.page-20}))),h=v.map(p.cardLibraryTemplate).join(""),c.refs.movieList.innerHTML=h,(0,l.initializePagination)(),P(),t(f).Notify.success("Removed successfully");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){c.refs.backdrop.classList.toggle("is-hidden"),c.refs.body.classList.toggle("locked"),window.removeEventListener("keydown",q),c.refs.modalCloseBtn.removeEventListener("click",P),c.refs.backdrop.removeEventListener("click",H),k?k.removeEventListener("click",M):E.removeEventListener("click",A)}function q(e){e.code="ESC",P()}function H(e){e.target===e.currentTarget&&P()}c.refs.movieList.addEventListener("click",(function(e){if(e.target===e.currentTarget)return;var t=e.target.closest("li");d.movieApi.id=t.dataset.id,d.movieApi.getMovie().then((function(e){var t,n=(0,T.dataFormat)(e);x=n,console.log(x),"watched"===l.paginationSettings.paginationType?(t=(0,p.selectedWatchedTemplate)(n),c.refs.movieModal.innerHTML=t,(k=document.querySelector("[data-watched-remove]")).addEventListener("click",M)):(t=(0,p.selectedQueueTemplate)(n),c.refs.movieModal.innerHTML=t,(E=document.querySelector("[data-queue-remove]")).addEventListener("click",A)),c.refs.backdrop.classList.toggle("is-hidden"),c.refs.body.classList.toggle("locked"),c.refs.modalCloseBtn.addEventListener("click",P),window.addEventListener("keydown",q),c.refs.backdrop.addEventListener("click",H)}))})),a("2yGCU"),a("4smAb")}();
//# sourceMappingURL=library.cfb8b218.js.map
