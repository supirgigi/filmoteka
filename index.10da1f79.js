function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},i={},s=t.parcelRequired7c6;null==s&&((s=function(e){if(e in n)return n[e].exports;if(e in i){var t=i[e];delete i[e];var s={id:e,exports:{}};return n[e]=s,t.call(s.exports,s,s.exports),s.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},t.parcelRequired7c6=s),s("epB3k"),s("krGWQ"),s("bMZn5");var a=s("epB3k"),o=s("krGWQ"),r=s("kFh99"),c=s("2nhTy"),d=s("9L75J"),u=s("ioBS9"),l=s("eyjy7"),f=s("bMZn5");(0,l.onAuthStateChanged)(f.auth,(e=>{e?(console.log("user logged in: ",e),o.refs.authSignOut.parentElement.classList.remove("hidden"),o.refs.authOpen.parentElement.classList.add("hidden")):(console.log("user logged out"),o.refs.authSignOut.parentElement.classList.add("hidden"),o.refs.authOpen.parentElement.classList.remove("hidden"))})),function(){u.spinner.show();try{a.movieApi.getTrending().then((e=>{console.log(e.results),c.paginationSettings.maxPages=e.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();const t=e.results.map(r.dataFormat).map(d.cardTemplate).join("");o.refs.movieList.innerHTML=t,o.refs.pagination.classList.remove("visually-hidden")}))}catch(e){Notiflix.Notify.failure(e.message)}finally{u.spinner.close()}}();a=s("epB3k"),o=s("krGWQ"),r=s("kFh99"),d=s("9L75J"),c=s("2nhTy"),u=s("ioBS9");var v=s("eWCmQ");o.refs.searchForm.addEventListener("submit",(function(t){t.preventDefault();const n=t.currentTarget.elements.search.value;if(""===n)return void e(v).Notify.failure("Please enter correct movie title");n!==a.movieApi.query&&(a.movieApi.query=n);u.spinner.show(),c.paginationSettings.paginationType="search",console.log(c.paginationSettings.paginationType),a.movieApi.resetPage();try{a.movieApi.searchMovies().then((t=>{if(0===t.results.length)return e(v).Notify.failure("No matches"),void u.spinner.close();console.log(t),c.paginationSettings.maxPages=t.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();const n=t.results.map(r.dataFormat).map(d.cardTemplate).join("");o.refs.movieList.innerHTML=n}))}catch(t){e(v).Notify.failure(t.message)}finally{u.spinner.close()}})),s("2nhTy");o=s("krGWQ"),a=s("epB3k"),r=s("kFh99"),f=s("bMZn5"),d=s("9L75J");var g=s("ftYLF");v=s("eWCmQ");let h,m,p;function y(){o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),window.removeEventListener("keydown",L),o.refs.modalCloseBtn.removeEventListener("click",y),o.refs.backdrop.removeEventListener("click",k),h.removeEventListener("click",E),m.removeEventListener("click",N),h.removeEventListener("click",M),m.removeEventListener("click",T)}function L(e){console.log(e.code),"Escape"===e.code&&y()}function k(e){e.target===e.currentTarget&&y()}function w(){"add to watched"===h.textContent?(h.textContent="remove from watched",h.removeEventListener("click",E),h.addEventListener("click",M),h.classList.add("modal-card-buttons__btn_current")):(h.textContent="add to watched",h.addEventListener("click",E),h.removeEventListener("click",M),h.classList.remove("modal-card-buttons__btn_current"))}function b(){"add to queue"===m.textContent?(m.textContent="remove from queue",m.removeEventListener("click",N),m.addEventListener("click",T),m.classList.add("modal-card-buttons__btn_current")):(m.textContent="add to queue",m.addEventListener("click",N),m.removeEventListener("click",T),m.classList.remove("modal-card-buttons__btn_current"))}async function E(){if(f.auth.currentUser)try{const{watchedMovies:t}=await(0,g.getDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));t.push(p),await(0,g.updateDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid),{watchedMovies:t}).then((()=>{e(v).Notify.success("Added to watched"),w()}))}catch(t){e(v).Notify.failure(t.message)}else e(v).Notify.failure("Please sign in")}async function M(){try{let{watchedMovies:t}=await(0,g.getDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));t=t.filter((e=>e.id!==p.id)),await(0,g.updateDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid),{watchedMovies:t}).then((()=>{e(v).Notify.success("Removed successfully"),w()}))}catch(t){e(v).Notify.failure(t.message)}}async function N(){if(f.auth.currentUser)try{const{queuedMovies:t}=await(0,g.getDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));t.push(p),await(0,g.updateDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid),{queuedMovies:t}).then((()=>{e(v).Notify.success("Added to queue"),b()}))}catch(t){e(v).Notify.failure(t.message)}else e(v).Notify.failure("Please sign in")}async function T(){try{let{queuedMovies:t}=await(0,g.getDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));t=t.filter((e=>e.id!==p.id)),await(0,g.updateDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid),{queuedMovies:t}).then((()=>{e(v).Notify.success("Removed successfully"),b()}))}catch(t){e(v).Notify.failure(t.message)}}o.refs.movieList.addEventListener("click",(async function(t){if(t.target===t.currentTarget)return;const n=t.target.closest("li");a.movieApi.id=n.dataset.id;try{a.movieApi.getMovie().then((async e=>{const t=(0,r.dataFormat)(e);p=t;const n=(0,d.selectedMovieTemplate)(t);if(o.refs.movieModal.innerHTML=n,h=document.querySelector("[data-watched-add]"),m=document.querySelector("[data-queue-add]"),h.addEventListener("click",E),m.addEventListener("click",N),f.auth.currentUser){const e=await(0,g.getDoc)((0,g.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));console.log(e);const{watchedMovies:t,queuedMovies:n}=e;t.find((e=>e.id===p.id))&&w(),n.find((e=>e.id===p.id))&&b()}o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),o.refs.modalCloseBtn.addEventListener("click",y),window.addEventListener("keydown",L),o.refs.backdrop.addEventListener("click",k)}))}catch(t){e(v).Notify.failure(t.message)}})),s("hMaZ9"),s("ioBS9");
//# sourceMappingURL=index.10da1f79.js.map
