function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},i={},n=t.parcelRequired7c6;null==n&&((n=function(e){if(e in s)return s[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return s[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},t.parcelRequired7c6=n),n("epB3k"),n("krGWQ"),n("bMZn5");var a=n("epB3k"),o=n("krGWQ"),r=n("kFh99"),c=n("2nhTy"),d=n("9L75J"),u=n("ioBS9"),l=n("eyjy7"),f=n("bMZn5");n("ftYLF"),(0,l.onAuthStateChanged)(f.auth,(e=>{e?(console.log("user logged in: ",e),o.refs.authSignOut.parentElement.classList.remove("hidden"),o.refs.authOpen.parentElement.classList.add("hidden")):(console.log("user logged out"),o.refs.authSignOut.parentElement.classList.add("hidden"),o.refs.authOpen.parentElement.classList.remove("hidden"))})),function(){u.spinner.show();try{a.movieApi.getTrending().then((e=>{console.log(e.results),c.paginationSettings.maxPages=e.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();const t=e.results.map(r.dataFormat).map(d.cardTemplate).join("");o.refs.movieList.innerHTML=t,o.refs.pagination.classList.remove("visually-hidden")}))}catch(e){Notiflix.Notify.failure(e.message)}finally{u.spinner.close()}}();a=n("epB3k"),o=n("krGWQ"),r=n("kFh99"),d=n("9L75J"),c=n("2nhTy"),u=n("ioBS9");var v=n("eWCmQ");o.refs.searchForm.addEventListener("submit",(function(t){t.preventDefault();const s=t.currentTarget.elements.search.value;if(""===s)return void e(v).Notify.failure("Please enter correct movie title");s!==a.movieApi.query&&(a.movieApi.query=s);u.spinner.show(),c.paginationSettings.paginationType="search",console.log(c.paginationSettings.paginationType),a.movieApi.resetPage();try{a.movieApi.searchMovies().then((t=>{if(0===t.results.length)return e(v).Notify.failure("No matches"),void u.spinner.close();console.log(t),c.paginationSettings.maxPages=t.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();const s=t.results.map(r.dataFormat).map(d.cardTemplate).join("");o.refs.movieList.innerHTML=s}))}catch(t){e(v).Notify.failure(t.message)}finally{u.spinner.close()}})),n("2nhTy");o=n("krGWQ"),a=n("epB3k"),r=n("kFh99"),f=n("bMZn5"),d=n("9L75J");var m=n("ftYLF");v=n("eWCmQ");let h,g,p;function y(){o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),window.removeEventListener("keydown",L),o.refs.modalCloseBtn.removeEventListener("click",y),o.refs.backdrop.removeEventListener("click",k),h.removeEventListener("click",b),g.removeEventListener("click",q),h.removeEventListener("click",M),g.removeEventListener("click",N)}function L(e){console.log(e.code),"Escape"===e.code&&y()}function k(e){e.target===e.currentTarget&&y()}function w(){"add to watched"===h.textContent?(h.textContent="remove from watched",h.removeEventListener("click",b),h.addEventListener("click",M),h.classList.add("modal-card-buttons__btn_current")):(h.textContent="add to watched",h.addEventListener("click",b),h.removeEventListener("click",M),h.classList.remove("modal-card-buttons__btn_current"))}function E(){"add to queue"===g.textContent?(g.textContent="remove from queue",g.removeEventListener("click",q),g.addEventListener("click",N),g.classList.add("modal-card-buttons__btn_current")):(g.textContent="add to queue",g.addEventListener("click",q),g.removeEventListener("click",N),g.classList.remove("modal-card-buttons__btn_current"))}async function b(){if(f.auth.currentUser)try{const t=await(0,m.getDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data())),{userId:s,watchedMovies:i,queuedMovies:n,userEmail:a}=t;i.push(p),await(0,m.setDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid),{userId:s,userEmail:a,watchedMovies:i,queuedMovies:n}).then((()=>{e(v).Notify.success("Added to watched"),w()}))}catch(t){e(v).Notify.failure(t.message)}else e(v).Notify.failure("Please sign in")}async function M(){try{const{userId:t,userEmail:s,watchedMovies:i,queuedMovies:n}=await(0,m.getDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data())),a=i.filter((e=>e.id!==p.id));await(0,m.setDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid),{userId:t,userEmail:s,watchedMovies:a,queuedMovies:n}).then((()=>{e(v).Notify.success("Removed successfully"),w()}))}catch(t){e(v).Notify.failure(t.message)}}async function q(){if(f.auth.currentUser)try{const t=await(0,m.getDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data())),{userId:s,watchedMovies:i,queuedMovies:n,userEmail:a}=t;n.push(p),await(0,m.setDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid),{userId:s,userEmail:a,watchedMovies:i,queuedMovies:n}).then((()=>{e(v).Notify.success("Added to queue"),E()}))}catch(t){e(v).Notify.failure(t.message)}else e(v).Notify.failure("Please sign in")}async function N(){try{const{userId:t,userEmail:s,watchedMovies:i,queuedMovies:n}=await(0,m.getDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data())),a=n.filter((e=>e.id!==p.id));await(0,m.setDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid),{userId:t,userEmail:s,watchedMovies:i,queuedMovies:a}).then((()=>{e(v).Notify.success("Removed successfully"),E()}))}catch(t){e(v).Notify.failure(t.message)}}o.refs.movieList.addEventListener("click",(async function(t){if(t.target===t.currentTarget)return;const s=t.target.closest("li");a.movieApi.id=s.dataset.id;try{a.movieApi.getMovie().then((async e=>{const t=(0,r.dataFormat)(e);p=t;const s=(0,d.selectedMovieTemplate)(t);if(o.refs.movieModal.innerHTML=s,h=document.querySelector("[data-watched-add]"),g=document.querySelector("[data-queue-add]"),h.addEventListener("click",b),g.addEventListener("click",q),f.auth.currentUser){const e=await(0,m.getDoc)((0,m.doc)(f.db,"users",f.auth.currentUser.uid)).then((e=>e.data()));console.log(e);const{watchedMovies:t,queuedMovies:s}=e,i=t.find((e=>e.id===p.id)),n=s.find((e=>e.id===p.id));i&&w(),n&&E()}o.refs.backdrop.classList.toggle("is-hidden"),o.refs.body.classList.toggle("locked"),o.refs.modalCloseBtn.addEventListener("click",y),window.addEventListener("keydown",L),o.refs.backdrop.addEventListener("click",k)}))}catch(t){e(v).Notify.failure(t.message)}})),n("hMaZ9"),n("ioBS9");
//# sourceMappingURL=index.75e88bbb.js.map
