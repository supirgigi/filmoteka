!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=t.parcelRequired7c6;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){r[e]=t},t.parcelRequired7c6=i),i("fkvfI"),i("4Nugj"),i("euqRf");var s=i("fkvfI"),a=i("4Nugj"),o=i("Db1qJ"),c=i("jcFG7"),u=i("bXAnp"),d=i("4smAb"),l=i("gQOBw"),f=i("euqRf");(0,l.onAuthStateChanged)(f.auth,(function(e){e?(console.log("user logged in: ",e),a.refs.authSignOut.parentElement.classList.remove("hidden"),a.refs.authOpen.parentElement.classList.add("hidden")):(console.log("user logged out"),a.refs.authSignOut.parentElement.classList.add("hidden"),a.refs.authOpen.parentElement.classList.remove("hidden"))})),function(){d.spinner.show();try{s.movieApi.getTrending().then((function(e){console.log(e.results),c.paginationSettings.maxPages=e.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();var t=e.results.map(o.dataFormat).map(u.cardTemplate).join("");a.refs.movieList.innerHTML=t,a.refs.pagination.classList.remove("visually-hidden")}))}catch(e){Notiflix.Notify.failure(e.message)}finally{d.spinner.close()}}();s=i("fkvfI"),a=i("4Nugj"),o=i("Db1qJ"),u=i("bXAnp"),c=i("jcFG7"),d=i("4smAb");var p=i("iU1Pc");a.refs.searchForm.addEventListener("submit",(function(t){t.preventDefault();var n=t.currentTarget.elements.search.value;if(""===n)return void e(p).Notify.failure("Please enter correct movie title");n!==s.movieApi.query&&(s.movieApi.query=n);d.spinner.show(),c.paginationSettings.paginationType="search",console.log(c.paginationSettings.paginationType),s.movieApi.resetPage();try{s.movieApi.searchMovies().then((function(t){if(0===t.results.length)return e(p).Notify.failure("No matches"),void d.spinner.close();console.log(t),c.paginationSettings.maxPages=t.total_pages,console.log(c.paginationSettings),(0,c.initializePagination)();var n=t.results.map(o.dataFormat).map(u.cardTemplate).join("");a.refs.movieList.innerHTML=n}))}catch(t){e(p).Notify.failure(t.message)}finally{d.spinner.close()}})),i("jcFG7");var v,h,g,m=i("bpxeT"),b=i("2TvXO"),y=(a=i("4Nugj"),s=i("fkvfI"),o=i("Db1qJ"),f=i("euqRf"),u=i("bXAnp"),i("6m2hf"));p=i("iU1Pc");function k(){return k=e(m)(e(b).mark((function t(n){var r;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.target!==n.currentTarget){t.next=2;break}return t.abrupt("return");case 2:r=n.target.closest("li"),s.movieApi.id=r.dataset.id;try{s.movieApi.getMovie().then(function(){var t=e(m)(e(b).mark((function t(n){var r,i,s,c,d;return e(b).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,o.dataFormat)(n),g=r,i=(0,u.selectedMovieTemplate)(r),a.refs.movieModal.innerHTML=i,L(),!f.auth.currentUser){e.next=13;break}return e.next=8,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 8:s=e.sent,console.log(s),c=s.watchedMovies,d=s.queuedMovies,c.find((function(e){return e.id===g.id}))&&N(),d.find((function(e){return e.id===g.id}))&&q();case 13:a.refs.backdrop.classList.toggle("is-hidden"),a.refs.body.classList.toggle("locked"),a.refs.modalCloseBtn.addEventListener("click",x),window.addEventListener("keydown",w),a.refs.backdrop.addEventListener("click",E);case 18:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(t){e(p).Notify.failure(t.message)}case 5:case"end":return t.stop()}}),t)}))),k.apply(this,arguments)}function L(){v=document.querySelector("[data-watched-add]"),h=document.querySelector("[data-queue-add]"),v.addEventListener("click",M),h.addEventListener("click",A)}function x(){a.refs.backdrop.classList.toggle("is-hidden"),a.refs.body.classList.toggle("locked"),window.removeEventListener("keydown",w),a.refs.modalCloseBtn.removeEventListener("click",x),a.refs.backdrop.removeEventListener("click",E),v.removeEventListener("click",M),h.removeEventListener("click",A),v.removeEventListener("click",T),h.removeEventListener("click",C)}function w(e){console.log(e.code),"Escape"===e.code&&x()}function E(e){e.target===e.currentTarget&&x()}function N(){"add to watched"===v.textContent?(v.textContent="remove from watched",v.removeEventListener("click",M),v.addEventListener("click",T),v.classList.add("modal-card-buttons__btn_current")):(v.textContent="add to watched",v.addEventListener("click",M),v.removeEventListener("click",T),v.classList.remove("modal-card-buttons__btn_current"))}function q(){"add to queue"===h.textContent?(h.textContent="remove from queue",h.removeEventListener("click",A),h.addEventListener("click",C),h.classList.add("modal-card-buttons__btn_current")):(h.textContent="add to queue",h.addEventListener("click",A),h.removeEventListener("click",C),h.classList.remove("modal-card-buttons__btn_current"))}function M(){return _.apply(this,arguments)}function _(){return(_=e(m)(e(b).mark((function t(){var n;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.auth.currentUser){t.next=3;break}return e(p).Notify.failure("Please sign in"),t.abrupt("return");case 3:return t.prev=3,t.next=6,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 6:return(n=t.sent.watchedMovies).push(g),t.next=10,(0,y.updateDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{watchedMovies:n}).then((function(){e(p).Notify.success("Added to watched"),N()}));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),e(p).Notify.failure(t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[3,12]])})))).apply(this,arguments)}function T(){return U.apply(this,arguments)}function U(){return(U=e(m)(e(b).mark((function t(){var n;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 3:return n=(n=t.sent.watchedMovies).filter((function(e){return e.id!==g.id})),t.next=7,(0,y.updateDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{watchedMovies:n}).then((function(){e(p).Notify.success("Removed successfully"),N()}));case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),e(p).Notify.failure(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}function A(){return D.apply(this,arguments)}function D(){return(D=e(m)(e(b).mark((function t(){var n;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f.auth.currentUser){t.next=3;break}return e(p).Notify.failure("Please sign in"),t.abrupt("return");case 3:return t.prev=3,t.next=6,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 6:return(n=t.sent.queuedMovies).push(g),t.next=10,(0,y.updateDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{queuedMovies:n}).then((function(){e(p).Notify.success("Added to queue"),q()}));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),e(p).Notify.failure(t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[3,12]])})))).apply(this,arguments)}function C(){return S.apply(this,arguments)}function S(){return(S=e(m)(e(b).mark((function t(){var n;return e(b).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,y.getDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid)).then((function(e){return e.data()}));case 3:return n=(n=t.sent.queuedMovies).filter((function(e){return e.id!==g.id})),t.next=7,(0,y.updateDoc)((0,y.doc)(f.db,"users",f.auth.currentUser.uid),{queuedMovies:n}).then((function(){e(p).Notify.success("Removed successfully"),q()}));case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),e(p).Notify.failure(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}a.refs.movieList.addEventListener("click",(function(e){return k.apply(this,arguments)})),i("2yGCU"),i("4smAb")}();
//# sourceMappingURL=index.415a5919.js.map
